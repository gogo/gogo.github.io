<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Documentation &middot; gogoprotobuf
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-0d">

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>GoGoProtobuf</p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/bench/">Benchmark Comparison</a>
        
      
    
      
        
          <a class="sidebar-nav-item active" href="/doc/">Documentation</a>
        
      
    
      
    
      
        
          <a class="sidebar-nav-item" href="/pbpath/">pbpath</a>
        
      
    

    <a class="sidebar-nav-item" href="http://godoc.org/github.com/gogo/protobuf">Godoc</a>
    <a class="sidebar-nav-item" href="https://drone.io/github.com/gogo/protobuf">Tests</a>
    <a class="sidebar-nav-item" href="https://github.com/gogo/protobuf/blob/master/test/example/example.proto">Example</a> 
    <a class="sidebar-nav-item" href="https://github.com/golang/protobuf/commit/73aaaa9eb61d74fbf7e256ca586a3a565b308eea">LatestGoProtobufMerge</a>
    <a class="sidebar-nav-item" href="https://groups.google.com/forum/#!forum/gogoprotobuf">GoogleGroup</a>
    <a class="sidebar-nav-item" href="https://github.com/gogo/protobuf">GitHub project</a>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2015. All rights reserved.
    </p>
    <p>
      Created by <a href="https://plus.google.com/u/0/+WalterSchulzeA">Walter Schulze</a>
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <label for="sidebar-checkbox" class="sidebar-toggle"></label>

          <h3 class="masthead-title">
            <a href="/" title="Home">gogoprotobuf</a>
            <small>Protocol Buffers in Go with Gadgets</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="page">
  <h1 class="page-title">Documentation</h1>
  <p>The <a href="http://github.com/gogo/protobuf/blob/master/README">README</a> has more information if you are getting started with go and protocol buffers.</p>

<p>Here is an <a href="https://github.com/gogo/protobuf/blob/master/test/example/example.proto">example.proto</a> which uses most of the gogoprotobuf code generation plugins.</p>

<p>Please also look at the example <a href="https://github.com/gogo/protobuf/blob/master/test/example/Makefile">Makefile</a> which shows how to specify the <code>descriptor.proto</code> and <code>gogo.proto</code> in your proto_path</p>

<p>The documentation at <a href="http://godoc.org/github.com/gogo/protobuf/gogoproto">http://godoc.org/github.com/gogo/protobuf/gogoproto</a> describes the extensions made to goprotobuf in more detail.</p>

<p>Also see <a href="http://godoc.org/github.com/gogo/protobuf/plugin/">http://godoc.org/github.com/gogo/protobuf/plugin/</a> for documentation of each of the extensions which have their own plugins.</p>

<h1>Fast Marshalling and Unmarshalling</h1>

<p>Generating a <code>Marshal</code>, <code>MarshalTo</code>, <code>Size</code> and <code>Unmarshal</code> method for a struct results in faster marshalling and unmarshalling than when using reflect.</p>

<p>See <a href="http://gogo.github.io/bench">BenchComparison</a> for a comparison between reflect and generated code used for marshalling and unmarshalling.</p>

<table>
<tr><td><b>Name</b></td><td><b>Option</b></td><td><b>Type</b></td><td><b>Description</b></td><td><b>Default</b></td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/marshalto">marshaler</a></td><td>Message</td><td>bool</td><td>if true, a Marshal and MarshalTo method is generated for the specific message</td><td>false</td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/size">sizer</a></td><td>Message</td><td>bool</td><td>if true, a Size method is generated for the specific message</td><td>false</td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/unmarshal">unmarshaler</a></td><td> Message </td><td> bool </td><td> if true, an Unmarshal method is generated for the specific message </td><td> false</td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/marshalto"> unsafe_marshaler</a> </td><td> Message </td><td> bool </td><td> if true, a Marshal and MarshalTo method is generated for the specific message. The generated code uses the unsafe package. </td><td> false</td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/unmarshal">unsafe_unmarshaler</a></td><td> Message </td><td> bool </td><td> if true, an Unmarshal method is generated for the specific message. The generated code uses the unsafe package. </td><td> false</td></tr>
</table>

<h1>More Canonical Go Structures</h1>

<p>Lots of times working with a goprotobuf struct will lead you to a place where you create another struct that is easier to work with and then have a function to copy the values between the two structs.</p>

<p>You might also find that basic structs that started their life as part of an API need to be sent over the wire. With gob, you could just send it. With goprotobuf, you need to make a new struct.</p>

<p><code>gogoprotobuf</code> tries to fix these problems with the nullable, embed, customtype and customname field extensions.</p>

<table>
<tr><td><b>Name</b></td><td><b>Option</b></td><td><b>Type</b></td><td><b>Description</b></td><td><b>Default</b></td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/gogoproto">nullable</a></td><td> Field </td><td> bool </td><td> if false, a field is generated without a pointer (see warning below). </td><td> true </td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/gogoproto">embed</a></td><td> Field </td><td> bool </td><td> if true, the field is generated as an embedded field. </td><td> false </td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/gogoproto">customtype</a> </td><td> Field </td><td> string </td><td> It works with the Marshal and Unmarshal methods, to allow you to have your own types in your struct, but marshal to bytes. For example, custom.Uuid or custom.Fixed128 </td><td> goprotobuf type </td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/gogoproto"> customname</a> (beta) </td><td> Field </td><td> string </td><td> Changes the generated fieldname. This is especially useful when generated methods conflict with fieldnames. </td><td> goprotobuf field name </td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/gogoproto"> casttype</a> (beta) </td><td> Field </td><td> string </td><td> Changes the generated field type. It assumes that this type is castable to the original goprotobuf field type.  It currently does not support maps, structs or enums. </td><td> goprotobuf field type </td></tr>
</table>

<p><code>Warning about nullable: according to the Protocol Buffer specification, you should be able to tell whether a field is set or unset. With the option nullable=false this feature is lost, since your non-nullable fields will always be set.</code> </p>

<p><code>Warning about customtype: It is your responsibility to test all cases of your marshaling, unmarshaling and size methods implemented for your custom type.</code></p>

<h1>Goprotobuf Compatibility</h1>

<p>Gogoprotobuf is compatible with Goprotobuf, because it is compatible with protocol buffers (see the section on tests below).</p>

<p>Gogoprotobuf generates the same code as goprotobuf if no extensions are used.</p>

<p>The enumprefix, getters and stringer extensions can be used to remove some of the unnecessary code generated by goprotobuf.</p>

<table>
<tr><td><b>Name</b></td><td><b>Option</b></td><td><b>Type</b></td><td><b>Description</b></td><td><b>Default</b></td></tr>
<tr><td> gogoproto_import </td><td> File </td><td> bool </td><td> if false, the generated code imports github.com/golang/protobuf/proto instead of github.com/gogo/protobuf/proto. </td><td> true </td></tr>
<tr><td> goproto_enum_prefix </td><td> Enum </td><td> bool </td><td> if false, generates the enum constant names without the messagetype prefix </td><td> true </td></tr>
<tr><td> goproto_getters </td><td> Message </td><td> bool </td><td> if false, the message is generated without get methods, this is useful when you would rather want to use face </td><td> true </td></tr>
<tr><td> goproto_stringer </td><td> Message </td><td> bool </td><td> if false, the message is generated without the default string method, this is useful for rather using stringer </td><td> true </td></tr>
<tr><td> goproto_enum_stringer (experimental) </td><td> Enum </td><td> bool </td><td> if false, the enum is generated without the default string method, this is useful for rather using enum_stringer </td><td> true </td></tr>
<tr><td> goproto_extensions_map (beta) </td><td> Message </td><td> bool </td><td> if false, the extensions field is generated as type []byte instead of type map[int32]proto.Extension </td><td> true </td></tr>
<tr><td> goproto_unrecognized (beta) </td><td> Message </td><td> bool </td><td>if false, XXX_unrecognized field is not generated. This is useful to reduce GC pressure at the cost of losing information about unrecognized fields. </td><td> true </td></tr>
</table>

<h1>Less Typing</h1>

<p>The Protocol Buffer language is very parseable and extra code can be easily generated for structures.</p>

<p>Helper methods, functions and interfaces can be generated by triggering certain extensions like gostring.</p>

<table>
<tr><td><b>Name</b></td><td><b>Option</b></td><td><b>Type</b></td><td><b>Description</b></td><td><b>Default</b></td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/gostring">gostring</a></td><td> Message </td><td> bool </td><td> if true, a `GoString` method is generated. This returns a string representing valid go code to reproduce the current state of the struct. </td><td> false </td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/union"> onlyone</a> </td><td> Message </td><td> bool </td><td> if true, all fields must be nullable and only one of the fields may be set, like a union. Two methods are generated: `GetValue() interface{}` and `SetValue(v interface{}) (set bool)`. These provide easier interaction with a union. </td><td> false </td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/equal"> equal</a></td><td> Message </td><td> bool </td><td> if true, an Equal method is generated </td><td> false </td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/equal"> verbose_equal</a> </td><td> Message </td><td> bool </td><td> if true, a verbose equal method is generated for the message. This returns an error which describes the exact element which is not equal to the exact element in the other struct. </td><td> false </td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/stringer"> stringer</a> </td><td> Message </td><td> bool </td><td> if true, a String method is generated for the message. </td><td> false </td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/face">face</a> </td><td> Message </td><td> bool </td><td> if true, a function will be generated which can convert a structure which satisfies an interface (face) to the specified structure. This interface contains getters for each of the fields in the struct. The specified struct is also generated with the getters. This allows it to satisfy its own face. </td><td> false </td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/description"> description</a> (beta) </td><td> Message </td><td> bool </td><td> if true, a Description method is generated for the message. </td><td> false </td></tr>
<tr><td> <a href="http://godoc.org/github.com/gogo/protobuf/plugin/populate"> populate</a> </td><td> Message </td><td> bool </td><td> if true, a `NewPopulated<MessageName>` function is generated. This is necessary for  generated tests. </td><td> false </td></tr>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/enumstringer"> enum_stringer</a> (experimental) </td><td> Enum </td><td> bool </td><td> if true, a String method is generated for an Enum </td><td> false </td></tr>
</table>

<h1>Peace of Mind</h1>

<p>Test and Benchmark generation is done with the following extensions:</p>

<table>
<tr><td><a href="http://godoc.org/github.com/gogo/protobuf/plugin/testgen">testgen</a> </td><td> Message </td><td> bool </td><td> if true, tests are generated for proto, json and prototext marshalling as well as for some of the other enabled plugins </td><td> false </td></tr>
<tr><td> benchgen </td><td> Message </td><td> bool </td><td> if true, benchmarks are generated for proto, json and prototext marshalling as well as for some of the other enabled plugins </td><td> false </td></tr>
</table>

<h1>More Serialization Formats</h1>

<p>Other serialization formats like xml and json typically use reflect to marshal and unmarshal structured data.  Manipulating these structs into something other than the default Go requires editing tags.  The following extensions provide ways of editing these tags for the generated protobuf structs.</p>

<table>
<tr><td><a href="https://github.com/gogo/protobuf/blob/master/test/tags/tags.proto">jsontag</a> (beta) </td><td> Field </td><td> string </td><td> if set, the json tag value between the double quotes is replaced with this string </td><td> fieldname </td></tr>
<tr><td><a href="https://github.com/gogo/protobuf/blob/master/test/tags/tags.proto">moretags</a> (beta) </td><td> Field </td><td> string </td><td> if set, this string is appended to the tag string </td><td> empty </td></tr>
</table>

<p><a href="https://groups.google.com/forum/#!topic/gogoprotobuf/xmFnqAS6MIc">Here is a longer explanation of jsontag and moretags</a></p>

<h1>File Options</h1>

<p>Each of the boolean message and enum extensions also have a file extension:</p>

<ul>
<li><code>marshaler_all</code></li>
<li><code>size_all</code></li>
<li><code>unmarshaler_all</code></li>
<li><code>unsafe_marshaler_all</code></li>
<li><code>unsafe_unmarshaler_all</code></li>
<li><code>goproto_enum_prefix_all</code></li>
<li><code>goproto_getters_all</code></li>
<li><code>goproto_stringer_all</code></li>
<li><code>goproto_enum_stringer_all</code></li>
<li><code>goproto_extensions_map_all</code></li>
<li><code>gostring_all</code></li>
<li><code>onlyone_all</code></li>
<li><code>equal_all</code></li>
<li><code>verbose_equal_all</code></li>
<li><code>stringer_all</code></li>
<li><code>enum_stringer_all</code></li>
<li><code>face_all</code></li>
<li><code>description_all</code></li>
<li><code>populate_all</code></li>
<li><code>testgen_all</code></li>
<li><code>benchgen_all</code></li>
</ul>

<p>Each of these are the same as their Message Option counterparts, except they apply to all messages in the file.  Their Message option counterparts can also be used to overwrite their effect.</p>

<h1>Installation</h1>

<p>To install it, you must first have Go (at least version 1.2.2) installed (see <a href="http://golang.org/doc/install">http://golang.org/doc/install</a>). </p>

<p>Next, install the standard protocol buffer implementation from <a href="https://github.com/google/protobuf">https://github.com/google/protobuf</a>; you must be running version 2.3, 2.4.1, 2.5, 2.6 or 2.6.1.</p>

<p>Finally run</p>
<div class="highlight"><pre><code class="text language-text" data-lang="text">go get github.com/gogo/protobuf/proto
go get github.com/gogo/protobuf/protoc-gen-gogo
go get github.com/gogo/protobuf/gogoproto
</code></pre></div>
<p>to install the support library and protocol compiler.</p>

<h1>Tests</h1>

<p><a href="https://drone.io/github.com/gogo/protobuf/latest"><img src="https://drone.io/github.com/gogo/protobuf/status.png" alt="Build Status"></a></p>

<ul>
<li>The normal barrage of tests are run with: <code>make tests</code> </li>
<li>An extra bombardment of tests are run with: <code>make testall</code></li>
<li>Tests for compatibility with <a href="https://github.com/golang/protobuf">golang/protobuf</a> are handled by a different project <a href="https://github.com/gogo/harmonytests">harmonytests</a>, since it requires goprotobuf.</li>
<li>Cross version tests are made with <a href="https://travis-ci.org/gogo/protobuf">Travis CI</a>.</li>
<li>GRPC Tests are also handled by a different project <a href="https://github.com/gogo/grpctests">grpctests</a>, since it depends on a lot of grpc libraries.</li>
</ul>

</div>

      </div>
    </div>

  </body>
</html>
